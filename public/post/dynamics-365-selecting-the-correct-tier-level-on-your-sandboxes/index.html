<!doctype html><html lang=zh><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><meta http-equiv=x-ua-compatible content="IE=edge, chrome=1"><title>Dynamics 365 Selecting the Correct Tier Level on Your Sandboxes | Blog My Life</title><meta name=Description content="A blog recording my life"><meta property="og:title" content="Dynamics 365 Selecting the Correct Tier Level on Your Sandboxes"><meta property="og:description" content="imgWhen purchasing Dynamics 365 F&O, you a get of Microsoft managed (but self-service) environments that is included with the standard offer. (Production, Tier-2 Standard Acceptance Testing and a Tier-1 Develop/Build and test environment.)
Microsoft have described this on the environment planningdocs. I will not discuss Tier-1 environments here, as these environments is optimized for development experiences. Do not perform performance testing on a tier-1 environment. Tier-2+ environments is based on the same architecture as a production environment and uses the Azure SQLDatabase service."><meta property="og:type" content="article"><meta property="og:url" content="https://www.nashome.cn/post/dynamics-365-selecting-the-correct-tier-level-on-your-sandboxes/"><meta property="article:published_time" content="2020-03-18T16:46:16+08:00"><meta property="article:modified_time" content="2020-03-18T16:46:16+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Dynamics 365 Selecting the Correct Tier Level on Your Sandboxes"><meta name=twitter:description content="imgWhen purchasing Dynamics 365 F&O, you a get of Microsoft managed (but self-service) environments that is included with the standard offer. (Production, Tier-2 Standard Acceptance Testing and a Tier-1 Develop/Build and test environment.)
Microsoft have described this on the environment planningdocs. I will not discuss Tier-1 environments here, as these environments is optimized for development experiences. Do not perform performance testing on a tier-1 environment. Tier-2+ environments is based on the same architecture as a production environment and uses the Azure SQLDatabase service."><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel=canonical href=https://www.nashome.cn/post/dynamics-365-selecting-the-correct-tier-level-on-your-sandboxes/><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=prev href=https://www.nashome.cn/post/dynamics-365-shipping-container-labeling-guide/><link rel=next href=https://www.nashome.cn/post/dynamics-365-pre-go-live-checklist/><link rel=stylesheet href=/css/style.min.css><link href=https://cdn.staticfile.org/font-awesome/5.12.1/css/all.min.css rel=stylesheet><link href=https://cdn.staticfile.org/animate.css/3.7.2/animate.css rel=stylesheet><link rel=stylesheet href=/css/search.min.css><link rel=stylesheet href=https://cdn.staticfile.org/jquery-modal/0.9.2/jquery.modal.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Dynamics 365 Selecting the Correct Tier Level on Your Sandboxes","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/www.nashome.cn\/post\/dynamics-365-selecting-the-correct-tier-level-on-your-sandboxes\/"},"image":{"@type":"ImageObject","url":"https:\/\/www.nashome.cn\/","width":800,"height":600},"genre":"post","keywords":"Dynamics365","wordcount":918,"url":"https:\/\/www.nashome.cn\/post\/dynamics-365-selecting-the-correct-tier-level-on-your-sandboxes\/","datePublished":"2020-03-18T16:46:16\x2b08:00","dateModified":"2020-03-18T16:46:16\x2b08:00","license":"This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher":{"@type":"Organization","name":"ZhaoQiang","logo":{"@type":"ImageObject","url":"https:\/\/www.nashome.cn\/","width":127,"height":40}},"description":""}</script></head><body><script>if(!window.localStorage||!window.localStorage.getItem('theme')){window.isDark=window.matchMedia('(prefers-color-scheme: dark)').matches;}else{window.isDark=(window.localStorage&&window.localStorage.getItem('theme'))==='dark';}
window.isDark&&document.body.classList.add('dark-theme');</script><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class="header-title animated bounceIn"><a href=https://www.nashome.cn/>Blog My Life</a></div><div class=menu><a class=menu-item href=https://www.nashome.cn/post>文章</a><a class=menu-item href=https://www.nashome.cn/tags>标签</a><a class=menu-item href=https://www.nashome.cn/categories>分类</a><a href=javascript:void(0); class=theme-switch title=切换主题>
<i class="fas fa-adjust fa-rotate-180 fa-fw"></i></a><a href=#ex1 rel=modal:open><i class="fas fa-search fa-fw"></i></a></div></div></header><header class=mobile id=header-mobile><div class=header-wrapper><div class=header-container><div class="header-title animated bounceIn"><a href=https://www.nashome.cn/>Blog My Life</a></div><div class=menu-toggle id=menu-toggle><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><a class=menu-item href=https://www.nashome.cn/post>文章</a><a class=menu-item href=https://www.nashome.cn/tags>标签</a><a class=menu-item href=https://www.nashome.cn/categories>分类</a><a href=javascript:void(0); class=theme-switch title=切换主题>
<i class="fas fa-adjust fa-rotate-180 fa-fw"></i></a><a href=#ex1 rel=modal:open><i class="fas fa-search fa-fw"></i></a></div></div></header><script>window.desktopHeaderMode=null;window.mobileHeaderMode=null;</script><main class=main><div class=container><article class="page single"><h1 class="single-title animated flipInX">Dynamics 365 Selecting the Correct Tier Level on Your Sandboxes</h1><div class=meta><div class=meta-line><a class=author href=https://www.nashome.cn/ rel=author target=_blank><i class="fas fa-user-circle fa-fw"></i>ZhaoQiang
</a>&nbsp;<span class=post-category>收录于&nbsp;<i class="far fa-folder fa-fw"></i><a href=https://www.nashome.cn/categories/dynamicsax/>Dynamicsax</a>&nbsp;</span></div><div class=meta-line><i class="far fa-calendar-alt fa-fw"></i><time datetime=2020-03-18>2020-03-18</time>&nbsp;
<i class="fas fa-pencil-alt fa-fw"></i>约 918 字&nbsp;
<i class="far fa-clock fa-fw"></i>预计阅读 5 分钟&nbsp;</div></div><div class=post-toc id=post-toc><h2 class=post-toc-title>目录</h2><div class=post-toc-content><nav id=TableOfContents></nav></div></div><div class=post-toc-mobile id=post-toc-mobile><details><summary><div class=post-toc-title><span>目录</span>
<span><i class="details icon fas fa-angle-down"></i></span></div></summary><div class=post-toc-content><nav id=TableOfContentsMobile></nav></div></details></div><div class=content><p><figure><img src=/svg/loading.min.svg data-sizes=auto data-src=https://nashome-image-bucket.oss-cn-shanghai.aliyuncs.com/Images/D365tierlevel/1.png alt=img title=img class=lazyload><figcaption class=image-caption>img</figcaption></figure></p><p>When purchasing Dynamics 365 F&O, you a get of Microsoft managed (but self-service) environments that is included with the standard offer. (Production, Tier-2 Standard Acceptance Testing and a Tier-1 Develop/Build and test environment.)</p><p>Microsoft have described this on the <a href=https://docs.microsoft.com/en-us/dynamics365/unified-operations/fin-and-ops/imp-lifecycle/environment-planning target=_blank>environment planning</a>
docs. I will not discuss Tier-1 environments here, as these environments is optimized for development experiences. Do not perform performance testing on a tier-1 environment. Tier-2+ environments is based on the same architecture as a production environment and uses the <a href=https://docs.microsoft.com/en-us/azure/sql-database/sql-database-technical-overview target=_blank>Azure SQL</a>
Database service.</p><p>When running an implementation project, it is common to purchase additional tier 2+ environment that is used of different purposes as shown in the table below (from Microsoft Docs)</p><p><figure><img src=/svg/loading.min.svg data-sizes=auto data-src=https://nashome-image-bucket.oss-cn-shanghai.aliyuncs.com/Images/D365tierlevel/2.png alt=img title=img class=lazyload><figcaption class=image-caption>img</figcaption></figure></p><p>Selecting the correct level is important and is depending on what the environment is going to be used for. As a guidance, Microsoft have the following baseline recommendation:</p><p><figure><img src=/svg/loading.min.svg data-sizes=auto data-src=https://nashome-image-bucket.oss-cn-shanghai.aliyuncs.com/Images/D365tierlevel/3.png alt=img title=img class=lazyload><figcaption class=image-caption>img</figcaption></figure></p><p>On the projects where I have been involved, we most often have 3 or 4 Tier 2+ environment and the purpose are changed through the project.</p><p><figure><img src=/svg/loading.min.svg data-sizes=auto data-src=https://nashome-image-bucket.oss-cn-shanghai.aliyuncs.com/Images/D365tierlevel/4.png alt=img title=img class=lazyload><figcaption class=image-caption>img</figcaption></figure></p><p>The flow of data between these environments can be included into a Sprint Cycle. The process will start with defining the general parameters in the golden configuration environment (1). Here all system setup, number sequences, and master data will be uploaded/entered from the legacy systems.</p><p>The Test/Stage/Migration environment (2) will be created based on the golden environment + transactional data packages/initial startup data. Then there will be a database refresh from Test (2) à UAT (2), where all test scripts will be run and approved. The results and configuration changes/master data are then fed into the golden environment ready for the next data movement cycle. The reason why we do this, is to ensure that the golden environment and the migration environment is not corrupted through testing. At Go Live, and when the UAT is approved (after a few iterations), then the Migration environment will be copied to the production environment.</p><p><strong>This can only happen once</strong>. Subsequent updates to the production environment must be done manually or using data packages.</p><p>(1)- Tier-2 Golden environment (before PROD have been deployed). This environment is often changed to become staging environment that contains an exact replica of the production environment. I prefer golden environments as a Tier-2, as this simplifies the transfer of data using the LCS self-service database refresh.</p><p>(2)- Tier-2 data migration. This environment is used for making transactional data ready for being imported to the production environment at Go-Live.</p><p>(3)- Tier-2/3 User acceptance. Here the system is really tested. Lot’s of regression testing and running test scripts. The focus is functionality. If there are concerns on performance, a Tier-5 environment can be purchased for a shorter period to validate that system can handle the full load of a large-scale production environment. For performance testing, it is recommended to also invest in automation of the test script. (Unless you ask the entire organization to participate in a manual test).</p><p>The performance of a system is a combination of the raw computing power of the VM’s hosing the AOS, and the sizing of the Azure SQL. With Dynamics 365 we don’t have any way’s of influencing the sizing of this. It is all managed by Microsoft, and they will size the production environment according to number of users and transactions per hour. But the Azure SQL boundaries that Microsoft is most often related to the following sizing steps.</p><p><figure><img src=/svg/loading.min.svg data-sizes=auto data-src=https://nashome-image-bucket.oss-cn-shanghai.aliyuncs.com/Images/D365tierlevel/5.png alt=img title=img class=lazyload><figcaption class=image-caption>img</figcaption></figure></p><p>I don’t exactly understand how Microsoft is mapping the Tier-2..5 towards these steps, but I have experienced that a Tier-2 level in some cases are a P1, P2, P4 and P6. More information on the DTU capacity can be found <a href=https://docs.microsoft.com/en-us/azure/sql-database/sql-database-service-tiers-dtu target=_blank>here</a>
, and the summary is that we can expect 48 IOPS per DTU. So, a P6 will provide 48000 IOPS. If you want to check your DTP limit, then open SQL manager towards the Azure SQL database, and execute the following script:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-sql data-lang=sql><span class=k>SELECT</span>
<span class=o>*</span>
<span class=k>FROM</span>
<span class=n>sys</span><span class=p>.</span><span class=n>dm_db_resource_stats</span> <span class=k>ORDER</span>
<span class=k>BY</span> <span class=n>end_time</span> <span class=k>DESC</span><span class=p>;</span>
</code></pre></td></tr></table></div></div><p>And then the DTU limit should be shown here: This is from a Tier-2 environment belonging to the initial subscription, and this seams to have 250 DTU’s(P2)</p><p><figure><img src=/svg/loading.min.svg data-sizes=auto data-src=https://nashome-image-bucket.oss-cn-shanghai.aliyuncs.com/Images/D365tierlevel/6.png alt=img title=img class=lazyload><figcaption class=image-caption>img</figcaption></figure></p><p>But what puzzles me is if I go into another Tier-2 <strong>add-on</strong> environment I have 500 DTU (P4)</p><p><figure><img src=/svg/loading.min.svg data-sizes=auto data-src=https://nashome-image-bucket.oss-cn-shanghai.aliyuncs.com/Images/D365tierlevel/7.png alt=img title=img class=lazyload><figcaption class=image-caption>img</figcaption></figure></p><p>And in the third Tier-2 add-on environment I have 1000 DTU (P6)</p><p><figure><img src=/svg/loading.min.svg data-sizes=auto data-src=https://nashome-image-bucket.oss-cn-shanghai.aliyuncs.com/Images/D365tierlevel/8.png alt=img title=img class=lazyload><figcaption class=image-caption>img</figcaption></figure></p><p>So there seams <strong>not</strong> to be a consistency between the DTU’s provided and the Tier-2 add-on purchased. As far as I know, in this case the production environment is 1000 DTU’s(Or P6) in some of my customers.</p><p>The AOS’es on the Tier-2 environment seams to mostly be D12/DS12/DS12_v2 with 4 CPU and 28 Gb RAM and 8x500Gb storage, capable of giving out 12.800 IOPS.</p><p>What also puzzles me is the number of Tier-2 AOS’s that is deployed. Some environments have one AOS, and one BI server.</p><p><figure><img src=/svg/loading.min.svg data-sizes=auto data-src=https://nashome-image-bucket.oss-cn-shanghai.aliyuncs.com/Images/D365tierlevel/9.png alt=img title=img class=lazyload><figcaption class=image-caption>img</figcaption></figure></p><p>While other Tier-2 environments have two AOS’es and one BI server</p><p><figure><img src=/svg/loading.min.svg data-sizes=auto data-src=https://nashome-image-bucket.oss-cn-shanghai.aliyuncs.com/Images/D365tierlevel/10.png alt=img title=img class=lazyload><figcaption class=image-caption>img</figcaption></figure></p><p>I assume that the differences are related to how the subscription estimator have been filled out, and that this may have an impact on what is deployed as sandbox Tier-2 environments.</p><p><figure><img src=/svg/loading.min.svg data-sizes=auto data-src=https://nashome-image-bucket.oss-cn-shanghai.aliyuncs.com/Images/D365tierlevel/11.png alt=img title=img class=lazyload><figcaption class=image-caption>img</figcaption></figure></p><p>Dynamics 365 do have some performance indicators under the system administrator menu, that gives some numbers, but I cannot see a clear correlation between the environments and the performance. Maybe some of you smart guys can explain how to interpret these performance test results? What is good, and what is not?</p><p><figure><img src=/svg/loading.min.svg data-sizes=auto data-src=https://nashome-image-bucket.oss-cn-shanghai.aliyuncs.com/Images/D365tierlevel/12.png alt=img title=img class=lazyload><figcaption class=image-caption>img</figcaption></figure></p><p>If we take the “LargeBufferReads”, how does your environments perform?</p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>本文于 2020-03-18 更新</span></div><div class=post-info-license></div></div><div class=post-info-line><div class=post-info-md><span><a class=link-to-markdown href=https://www.nashome.cn/post/dynamics-365-selecting-the-correct-tier-level-on-your-sandboxes/index.md target=_blank>阅读原始文档</a></span></div><div class=post-info-share><span><a href=javascript:void(0); title="分享到 微博" data-sharer=weibo data-url=https://www.nashome.cn/post/dynamics-365-selecting-the-correct-tier-level-on-your-sandboxes/ data-title="Dynamics 365 Selecting the Correct Tier Level on Your Sandboxes"><i class="fab fa-weibo fa-fw"></i></a><a href=javascript:void(0); title="分享到 百度" data-sharer=baidu data-url=https://www.nashome.cn/post/dynamics-365-selecting-the-correct-tier-level-on-your-sandboxes/ data-title="Dynamics 365 Selecting the Correct Tier Level on Your Sandboxes"><i class="loveit it-baidu-fill"></i></a><a href=javascript:void(0); title="分享到 Evernote" data-sharer=evernote data-url=https://www.nashome.cn/post/dynamics-365-selecting-the-correct-tier-level-on-your-sandboxes/ data-title="Dynamics 365 Selecting the Correct Tier Level on Your Sandboxes"><i class="fab fa-evernote fa-fw"></i></a></span></div></div></div><div class=post-info-more><section><span class=tag><a href=https://www.nashome.cn/tags/dynamics365/><i class="fas fa-tag fa-fw"></i>&nbsp;Dynamics365</a>&nbsp;</span></section><section><span><a href=javascript:window.history.back();>返回</a></span>&nbsp;|&nbsp;<span><a href=https://www.nashome.cn/>主页</a></span></section></div><div class=post-nav><a href=https://www.nashome.cn/post/dynamics-365-shipping-container-labeling-guide/ class=prev rel=prev title="Dynamics 365 货运集装箱标签指南"><i class="fas fa-angle-left fa-fw"></i>Dynamics 365 货运集装箱标签指南</a>
<a href=https://www.nashome.cn/post/dynamics-365-pre-go-live-checklist/ class=next rel=next title="Dynamics 365 Pre Go Live Checklist">Dynamics 365 Pre Go Live Checklist<i class="fas fa-angle-right fa-fw"></i></a></div></div><div class=comment><div id=valine></div><script>document.addEventListener("DOMContentLoaded",function(event){new Valine({el:'#valine',appId:'Bu42IhLNJc94WvCDKSsRwTqa-gzGzoHsz',appKey:'bKSP5XiBoIHs8PyXC4uhGhqQ',placeholder:'说点什么吧...',avatar:'mm',pageSize:10,lang:'zh-cn',visitor:true,recordIP:true,});});</script><noscript>Please enable JavaScript to view the <a href=https://valine.js.org/>comments powered by Valine.</a></noscript></div></article></div></main><footer class=footer><div class=copyright><div class=copyright-line>由 <a href=https://gohugo.io/ target=_blank rel="external nofollow noopener noreffer">Hugo</a> 强力驱动 | 主题 - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="external nofollow noopener noreffer">LoveIt<i class="far fa-heart fa-fw"></i></a></div><div class=copyright-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2016 - 2020</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=https://www.nashome.cn/ target=_blank>ZhaoQiang</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span><span class=icp-splitter>&nbsp;|&nbsp;</span><br class=icp-br><span class=icp><a href=http://www.beian.miit.gov.cn>沪ICP备17033498号</a></span></div></div></footer></div><a href=# class="dynamic-to-top animated faster" id=dynamic-to-top><span>&nbsp;</span>
</a><link rel=stylesheet href=/css/lib/valine/dark.css><link rel=stylesheet href=/css/lib/iconfont/iconfont.min.css><script src=https://cdn.staticfile.org/valine/1.3.10/Valine.min.js></script><script src=https://cdn.staticfile.org/smooth-scroll/16.1.0/smooth-scroll.polyfills.min.js></script><script src=https://cdn.staticfile.org/lazysizes/5.2.0/lazysizes.min.js></script><script src=/js/lib/sharer/sharer.min.js></script><script src=/js/theme.min.js></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-105751499-1','auto');ga('set','anonymizeIp',true);ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script src=https://cdn.staticfile.org/jquery/3.4.1/jquery.min.js></script><script src=https://cdn.staticfile.org/jquery-modal/0.9.2/jquery.modal.min.js></script><script src=https://res.cloudinary.com/jimmysong/raw/upload/rootsongjc-hugo/algoliasearch.min.js></script><script src=https://cdn.staticfile.org/autocomplete.js/0.37.1/autocomplete.min.js></script><script src=/js/search.js type=text/javascript></script><script data-ad-client=ca-pub-3216129127646136 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><script src=/js/baidutuisong.js async></script><div id=ex1 class=modal><div class=aa-input-container id=aa-input-container><input type=search id=aa-search-input class=aa-input-search placeholder="Search for titles or URIs..." name=search autocomplete=off><svg class="aa-input-icon" viewBox="654 -372 1664 1664"><path d="M1806 332c0-123.3-43.8-228.8-131.5-316.5C1586.8-72.2 1481.3-116 1358-116s-228.8 43.8-316.5 131.5S910 208.7 910 332s43.8 228.8 131.5 316.5S1234.7 780 1358 780s228.8-43.8 316.5-131.5S1806 455.3 1806 332zm512 832c0 34.7-12.7 64.7-38 90s-55.3 38-90 38c-36 0-66-12.7-90-38l-343-342c-119.3 82.7-252.3 124-399 124-95.3.0-186.5-18.5-273.5-55.5s-162-87-225-150-113-138-150-225S654 427.3 654 332s18.5-186.5 55.5-273.5 87-162 150-225 138-113 225-150S1262.7-372 1358-372s186.5 18.5 273.5 55.5 162 87 225 150 113 138 150 225S2062 236.7 2062 332c0 146.7-41.3 279.7-124 399l343 343C2305.7 1098.7 2318 1128.7 2318 1164z" /></svg></div></div></body></html>